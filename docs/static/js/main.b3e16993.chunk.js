(this["webpackJsonpreact-tetris"]=this["webpackJsonpreact-tetris"]||[]).push([[0],[,,,,,,,,,,function(e,t,a){e.exports=a.p+"static/media/tetris-bg.4ae866dc.mp3"},function(e,t,a){e.exports=a(20)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),o=a(8),r=a.n(o),s=(a(16),a(0)),c=a(9),h=a(3),l=a(2),u=a(5),p=a(4);a(17);function f(e){var t=["pixel"];return e.isFilled&&t.push("pixel--filled"),i.a.createElement("div",{className:t.join(" ")})}f.defaultProps={isFilled:!1};var d=f;a(18);function m(e){for(var t=e.rows,a=e.cols,n=e.pixelMap,o=[],r=0;r<t;r++){for(var s=[],c=0;c<a;c++)s.push(i.a.createElement(d,{key:"".concat(r,",").concat(c),isFilled:n[r][c]}));o.push(i.a.createElement("div",{key:"row-".concat(r)},s))}return i.a.createElement("div",{className:"grid"},o)}m.defaultProps={rows:20,cols:10};var v=m,w=a(6),b=function e(){Object(s.a)(this,e),this.size=0,this.orientations=null},O=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(h.a)(this,Object(l.a)(t).call(this,e))).size=2,a.orientations=[[[1,1],[1,1]]],a}return Object(p.a)(t,e),t}(b),j=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(h.a)(this,Object(l.a)(t).call(this,e))).size=4,a.orientations=[[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]],[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]]],a}return Object(p.a)(t,e),t}(b),g=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(h.a)(this,Object(l.a)(t).call(this,e))).size=3,a.orientations=[[[0,0,1],[0,0,1],[0,1,1]],[[1,0,0],[1,1,1],[0,0,0]],[[1,1,0],[1,0,0],[1,0,0]],[[1,1,1],[0,0,1],[0,0,0]]],a}return Object(p.a)(t,e),t}(b),P=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(h.a)(this,Object(l.a)(t).call(this,e))).size=3,a.orientations=[[[1,0,0],[1,0,0],[1,1,0]],[[0,0,1],[1,1,1],[0,0,0]],[[0,1,1],[0,0,1],[0,0,1]],[[1,1,1],[1,0,0],[0,0,0]]],a}return Object(p.a)(t,e),t}(b),y=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(h.a)(this,Object(l.a)(t).call(this,e))).size=3,a.orientations=[[[0,1,1],[1,1,0],[0,0,0]],[[0,1,0],[0,1,1],[0,0,1]]],a}return Object(p.a)(t,e),t}(b),x=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(h.a)(this,Object(l.a)(t).call(this,e))).size=3,a.orientations=[[[0,1,0],[1,1,1],[0,0,0]],[[0,1,0],[0,1,1],[0,1,0]],[[0,0,0],[1,1,1],[0,1,0]],[[0,1,0],[1,1,0],[0,1,0]]],a}return Object(p.a)(t,e),t}(b),M=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(h.a)(this,Object(l.a)(t).call(this,e))).size=3,a.orientations=[[[1,1,0],[0,1,1],[0,0,0]],[[0,0,1],[0,1,1],[0,1,0]]],a}return Object(p.a)(t,e),t}(b),k=0,S=1,E=2,C=3,G=4,R=5,z=6,U=function e(){var t=this;Object(s.a)(this,e),this.getShape=function(e){switch(e){case k:return new O;case S:return new x;case E:return new y;case C:return new M;case G:return new j;case R:return new P;case z:return new g;default:return new j}},this.getRandomShape=function(){var e=Math.floor(7*Math.random());return t.getShape(e)}},T=function e(t){var a=this;Object(s.a)(this,e),this.deregisterView=function(){a.view=null},this.initGame=function(){a.shape=null,a.shapePosition=[0,0],a.shapeRotation=0,a.unclearPixelMap=a.getEmptyPixelMap(),a.isSpeedUp=!1,a.isGameEnded=!1,a.timer=null},this.startGame=function(){a.timer=setTimeout(a.doGameTick,500),a.getNextShape()},this.endGame=function(){a.isGameEnded=!0,alert("Game Over!")},this.doGameTick=function(){a.isGameEnded?(a.initGame(),a.startGame()):(a.moveShapeDown(),a.timer=setTimeout(a.doGameTick,a.isSpeedUp?200:500))},this.updateView=function(e){a.view&&a.view.setState({pixelMap:e})},this.getEmptyPixelMap=function(){for(var e=[],t=0;t<20;t++){for(var a=[],n=0;n<10;n++)a.push(!1);e.push(a)}return e},this.addShapeToUnclearPixelMap=function(){for(var e=a.shape.orientations[a.shapeRotation],t=a.shape.size,n=Object(w.a)(a.shapePosition,2),i=n[0],o=n[1],r=0;r<t;r++)for(var s=0;s<t;s++)if(1===e[r][s]){var c=i+s,h=o+r;c>=0&&c<10&&h>=0&&h<20&&(a.unclearPixelMap[h][c]=!0)}},this.calculatePixelMap=function(){for(var e=a.getEmptyPixelMap(),t=a.shape.orientations[a.shapeRotation],n=a.shape.size,i=Object(w.a)(a.shapePosition,2),o=i[0],r=i[1],s=0;s<20;s++)for(var c=0;c<10;c++)e[s][c]=a.unclearPixelMap[s][c];for(s=0;s<n;s++)for(c=0;c<n;c++)if(1===t[s][c]){var h=o+c,l=r+s;h>=0&&h<10&&l>=0&&l<20&&(e[l][h]=!0)}return e},this.hasCollision=function(e,t){for(var n=a.shape.orientations[t],i=a.shape.size,o=Object(w.a)(e,2),r=o[0],s=o[1],c=0;c<i;c++)for(var h=0;h<i;h++)if(1===n[c][h]){var l=r+h,u=s+c;if(u<0)continue;if(u>=20)return!0;if(l<0||l>=10)return!0;if(!0===a.unclearPixelMap[u][l])return!0}return!1},this.isGameOver=function(){for(var e=a.shape.orientations[a.shapeRotation],t=a.shape.size,n=a.shapePosition[1],i=0;i<t;i++)for(var o=0;o<t;o++){if(1===e[i][o])if(n+i<0)return!0}return!1},this.findRowsToClear=function(){for(var e=[],t=0;t<20;t++){for(var n=!0,i=0;i<10;i++)n&=a.unclearPixelMap[t][i];n&&e.push(t)}return e},this.clearRows=function(e){for(var t=e.length-1;t>=0;t--)a.unclearPixelMap.splice(e[t],1);for(var n=0;n<e.length;n++){for(var i=[],o=0;o<10;o++)i.push(!1);a.unclearPixelMap.unshift(i)}},this.getNextShape=function(){a.shape=a.shapeFactory.getRandomShape(),a.shapeRotation=Math.floor(Math.random()*a.shape.orientations.length),a.shapePosition=[Math.floor((10-a.shape.size)/2),-a.shape.size]},this.moveShapeDown=function(){var e=[a.shapePosition[0],a.shapePosition[1]+1];if(a.hasCollision(e,a.shapeRotation))if(a.isGameOver())a.endGame();else{a.addShapeToUnclearPixelMap();var t=a.findRowsToClear();a.clearRows(t),a.getNextShape()}else a.shapePosition=[].concat(e);a.redraw()},this.moveShapeLeft=function(){var e=[a.shapePosition[0]-1,a.shapePosition[1]];a.hasCollision(e,a.shapeRotation)||(a.shapePosition=[].concat(e),a.redraw())},this.moveShapeRight=function(){var e=[a.shapePosition[0]+1,a.shapePosition[1]];a.hasCollision(e,a.shapeRotation)||(a.shapePosition=[].concat(e),a.redraw())},this.rotateShape=function(){var e=a.shape.orientations.length,t=(a.shapeRotation+1)%e;a.hasCollision(a.shapePosition,t)||(a.shapeRotation=t,a.redraw())},this.speedUp=function(){a.isSpeedUp=!0,clearTimeout(a.timer),a.doGameTick()},this.speedDown=function(){a.isSpeedUp=!1},this.redraw=function(){var e=a.calculatePixelMap();a.updateView(e)},this.view=t,this.shapeFactory=new U},D=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(h.a)(this,Object(l.a)(t).call(this,e))).handleKeyDown=function(e){switch(e.keyCode){case 32:case 38:a.gameController.rotateShape();break;case 37:a.gameController.moveShapeLeft();break;case 39:a.gameController.moveShapeRight();break;case 40:a.gameController.speedUp()}},a.handleKeyUp=function(e){switch(e.keyCode){case 40:a.gameController.speedDown()}},a.gameController=new T(Object(u.a)(a)),a.gameController.initGame(),a.state={},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.gameController.startGame(),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp),this.gameController.deregisterView()}},{key:"render",value:function(){var e=this.state.pixelMap;return i.a.createElement("div",null,e&&i.a.createElement(v,{pixelMap:e}))}}]),t}(i.a.Component),K=a(10),L=a.n(K);a(19);var N=function(){return i.a.createElement("div",{className:"app"},i.a.createElement(D,null),i.a.createElement("audio",{src:L.a,type:"audio/mpeg",autoPlay:!0,loop:!0}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[11,1,2]]]);
//# sourceMappingURL=main.b3e16993.chunk.js.map